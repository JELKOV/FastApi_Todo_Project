# π§ PyTest μ‹¤μµ μ§„ν–‰ μƒν™© λ³΄κ³ μ„

## π“‹ κ°μ”
μ΄ λ¬Έμ„λ” PyTest ν•™μµ κ³Όμ •μ—μ„ μ§„ν–‰ν• μ‹¤μµ λ‚΄μ©κ³Ό κ²°κ³Όλ¥Ό μ •λ¦¬ν• λ³΄κ³ μ„μ…λ‹λ‹¤.

---

## π― ν•™μµ λ©ν‘
- PyTest κΈ°λ³Έ κ°λ… μ΄ν•΄
- ν…μ¤νΈ ν™κ²½ κµ¬μ¶• λ° μ„¤μ •
- Mockκ³Ό Fixture ν™μ©λ²• ν•™μµ
- FastAPI μ• ν”λ¦¬μΌ€μ΄μ…μ— λ€ν• μΆ…ν•©μ μΈ ν…μ¤νΈ μ‘μ„±

---

## β… μ™„λ£λ μ‹¤μµ ν•­λ©

### 1οΈβƒ£ **PyTest μ„Έν…** β…
**νμΌ**: `tests/conftest.py`, `tests/unit/test_basic.py`

#### μ§„ν–‰ λ‚΄μ©:
- ν…μ¤νΈ λ””λ ‰ν† λ¦¬ κµ¬μ΅° μƒμ„±
- pytest.ini μ„¤μ • νμΌ μ μ©
- κΈ°λ³Έ conftest.py ν”½μ¤μ² μ„¤μ •
- μΈλ©”λ¨λ¦¬ SQLite ν…μ¤νΈ λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±
- FastAPI TestClient μ„¤μ •

#### ν…μ¤νΈ κ²°κ³Ό:
```
7 passed, 6 warnings in 0.13s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **ν…μ¤νΈ κ²©λ¦¬**: κ° ν…μ¤νΈλ§λ‹¤ λ…λ¦½μ μΈ λ°μ΄ν„°λ² μ΄μ¤ μ„Έμ…
- **ν”½μ¤μ² μμ΅΄μ„±**: `session` β†’ `client` β†’ ν…μ¤νΈ ν•¨μ
- **FastAPI ν†µν•©**: TestClientλ¥Ό ν†µν• API ν…μ¤νΈ ν™κ²½

---

### 2οΈβƒ£ **GET μ „μ²΄ μ΅°ν API ν…μ¤νΈ** β…
**νμΌ**: `tests/integration/test_get_todos.py`

#### μ§„ν–‰ λ‚΄μ©:
- λΉ λ©λ΅ μ΅°ν ν…μ¤νΈ
- λ°μ΄ν„°κ°€ μλ” λ©λ΅ μ΅°ν ν…μ¤νΈ
- νμ΄μ§• κΈ°λ¥ ν…μ¤νΈ
- ν•„ν„°λ§ ν…μ¤νΈ (μ™„λ£ μƒνƒ, μ°μ„ μμ„)
- μ •λ ¬ κΈ°λ¥ ν…μ¤νΈ (μ¤λ¦„μ°¨μ, λ‚΄λ¦Όμ°¨μ)
- λ³µν•© ν•„ν„°λ§ ν…μ¤νΈ
- μλ»λ νλΌλ―Έν„° κ²€μ¦ ν…μ¤νΈ

#### ν…μ¤νΈ κ²°κ³Ό:
```
9 passed, 6 warnings in 0.85s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **ν†µν•© ν…μ¤νΈ**: μ‹¤μ  API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ
- **λ°μ΄ν„° μƒμ„±**: ν…μ¤νΈ λ°μ΄ν„° μλ™ μƒμ„± λ° κ²€μ¦
- **μ‘λ‹µ κµ¬μ΅° κ²€μ¦**: ν‘μ¤€ν™”λ μ‘λ‹µ ν•μ‹ ν™•μΈ
- **μ—λ¬ μΌ€μ΄μ¤**: 422 Unprocessable Entity μ²λ¦¬

---

### 3οΈβƒ£ **PyTest Mocking** β…
**νμΌ**: `tests/unit/test_mocking.py`

#### μ§„ν–‰ λ‚΄μ©:
- Mock κΈ°λ³Έ μ‚¬μ©λ²• (Mock κ°μ²΄ μƒμ„±, λ©”μ„λ“ νΈμ¶ κ²€μ¦)
- Side Effect ν™μ© (μμ™Έ λ°μƒ, μμ°¨μ  κ°’ λ°ν™)
- λ°μ΄ν„°λ² μ΄μ¤ Mock (μΏΌλ¦¬ μ²΄μΈ, νΈλμ­μ… μ‹λ®¬λ μ΄μ…)
- μ™Έλ¶€ μμ΅΄μ„± Mock (HTTP μ”μ²­, νμΌ μ‘μ—…, μ‹κ°„)
- Context Manager Mock
- λΉ„λ™κΈ° Mock

#### ν…μ¤νΈ κ²°κ³Ό:
```
11 passed, 6 warnings in 0.11s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **μμ΅΄μ„± κ²©λ¦¬**: μ™Έλ¶€ μμ΅΄μ„±μ„ MockμΌλ΅ λ€μ²΄
- **Mock κ²€μ¦**: νΈμ¶ νμ, μΈμ, λ°ν™κ°’ κ²€μ¦
- **λ³µμ΅ν• μ‹λ‚λ¦¬μ¤**: Mock μ²΄μΈκ³Ό μμ΅΄μ„± κ΄€λ¦¬

---

### 4οΈβƒ£ **PyTest Fixture** β…
**νμΌ**: `tests/unit/test_fixtures.py`

#### μ§„ν–‰ λ‚΄μ©:
- κΈ°λ³Έ Fixture μ‚¬μ©λ²•
- Fixture Scope (function, class, module, session)
- Fixture μμ΅΄μ„± μ²΄μΈ
- Fixture νλΌλ―Έν„°ν™” (params)
- μ»¤μ¤ν…€ Fixture μƒμ„±
- Fixture Teardown (λ¦¬μ†μ¤ μ •λ¦¬)
- Fixture κ³µμ  λ° Autouse

#### ν…μ¤νΈ κ²°κ³Ό:
```
31 passed, 6 warnings in 0.31s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **Scope κ΄€λ¦¬**: ν…μ¤νΈλ³„, ν΄λμ¤λ³„, μ„Έμ…λ³„ λ¦¬μ†μ¤ κ΄€λ¦¬
- **μμ΅΄μ„± μ²΄μΈ**: Fixture κ°„ λ³µμ΅ν• μμ΅΄μ„± κµ¬μ΅°
- **νλΌλ―Έν„°ν™”**: ν•λ‚μ ν…μ¤νΈλ΅ μ—¬λ¬ μ‹λ‚λ¦¬μ¤ κ²€μ¦
- **λ¦¬μ†μ¤ κ΄€λ¦¬**: μλ™ μ •λ¦¬μ™€ μλ™ μ •λ¦¬

---

### 5οΈβƒ£ **GET λ‹¨μΌ μ΅°ν API ν…μ¤νΈ** β…
**νμΌ**: `tests/integration/test_get_todo.py`

#### μ§„ν–‰ λ‚΄μ©:
- μ ν¨ν• IDλ΅ TODO μ΅°ν
- μ΅΄μ¬ν•μ§€ μ•λ” IDλ΅ μ΅°ν (404)
- μλ»λ ID ν•μ‹μΌλ΅ μ΅°ν (422)
- μμ/0 ID μ²λ¦¬
- μ—¬λ¬ TODO μƒμ„± ν›„ κ°λ³„ μ΅°ν
- μ‘λ‹µ μΌκ΄€μ„± ν…μ¤νΈ
- μμ • ν›„ μ΅°ν ν…μ¤νΈ

#### ν…μ¤νΈ κ²°κ³Ό:
```
8 passed, 6 warnings in 0.15s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **λ‹¨μΌ λ¦¬μ†μ¤ μ΅°ν**: νΉμ • TODO ν•­λ©μ μƒμ„Έ μ •λ³΄ μ΅°ν
- **μ—λ¬ μ²λ¦¬**: 404, 422 μƒνƒ μ½”λ“ μ²λ¦¬
- **λ°μ΄ν„° μΌκ΄€μ„±**: μ—¬λ¬ λ² μ΅°ν μ‹ λ™μΌν• κ²°κ³Ό λ³΄μ¥

---

### 6οΈβƒ£ **POST API ν…μ¤νΈ** β…
**νμΌ**: `tests/integration/test_post_todo.py`

#### μ§„ν–‰ λ‚΄μ©:
- μ ν¨ν• λ°μ΄ν„°λ΅ TODO μƒμ„±
- μµμ† λ°μ΄ν„°λ΅ TODO μƒμ„± (κΈ°λ³Έκ°’ μ μ©)
- λ¨λ“  ν•„λ“ ν¬ν•¨ TODO μƒμ„±
- λΉ μ λ©, κΈ΄ μ λ©/μ„¤λ… κ²€μ¦
- μλ»λ μ°μ„ μμ„ κ°’ κ²€μ¦
- ν•„μ ν•„λ“ λ„λ½ κ²€μ¦
- μλ»λ ν•„λ“ νƒ€μ… κ²€μ¦
- μ—¬λ¬ TODO μƒμ„± μ‹ κ³ μ  ID ν• λ‹Ή
- μ λ‹μ½”λ“ λ¬Έμ μ²λ¦¬

#### ν…μ¤νΈ κ²°κ³Ό:
```
13 passed, 6 warnings in 0.25s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **λ°μ΄ν„° κ²€μ¦**: Pydantic λ¨λΈμ„ ν†µν• μ…λ ¥ κ²€μ¦
- **κΈ°λ³Έκ°’ μ²λ¦¬**: λ„λ½λ ν•„λ“μ— λ€ν• κΈ°λ³Έκ°’ μ μ©
- **μ λ‹μ½”λ“ μ§€μ›**: λ‹¤μ–‘ν• μ–Έμ–΄μ™€ νΉμ λ¬Έμ μ²λ¦¬
- **ID μλ™ ν• λ‹Ή**: λ°μ΄ν„°λ² μ΄μ¤ μλ™ μ¦κ°€ ID

---

### 7οΈβƒ£ **PATCH API ν…μ¤νΈ** β…
**νμΌ**: `tests/integration/test_patch_todo.py`

#### μ§„ν–‰ λ‚΄μ©:
- TODO μƒνƒ False β†’ True ν† κΈ€
- TODO μƒνƒ True β†’ False ν† κΈ€
- μ—¬λ¬ λ² ν† κΈ€ ν…μ¤νΈ
- μ΅΄μ¬ν•μ§€ μ•λ” TODO ν† κΈ€ (404)
- μλ»λ ID ν•μ‹μΌλ΅ ν† κΈ€ (422)
- μμ/0 ID μ²λ¦¬
- λ‹¤λ¥Έ ν•„λ“ λ³΄μ΅΄ ν™•μΈ
- updated_at λ³€κ²½ ν™•μΈ
- μ—¬λ¬ TODO κ°λ³„ ν† κΈ€
- μ‘λ‹µ μΌκ΄€μ„± ν…μ¤νΈ
- λ‹¤λ¥Έ μ‘μ—… ν›„ ν† κΈ€

#### ν…μ¤νΈ κ²°κ³Ό:
```
11 passed, 6 warnings in 0.20s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **μƒνƒ ν† κΈ€**: completed ν•„λ“μ True/False μ „ν™
- **ν•„λ“ λ³΄μ΅΄**: ν† κΈ€ μ‹ λ‹¤λ¥Έ ν•„λ“ κ°’ μ μ§€
- **νƒ€μ„μ¤νƒ¬ν”„ μ—…λ°μ΄νΈ**: μƒνƒ λ³€κ²½ μ‹ updated_at κ°±μ‹ 
- **λ¶€λ¶„ μ—…λ°μ΄νΈ**: PATCH λ©”μ„λ“μ νΉμ„± ν™μ©

---

### 8οΈβƒ£ **DELETE API ν…μ¤νΈ** β…
**νμΌ**: `tests/integration/test_delete_todo.py`

#### μ§„ν–‰ λ‚΄μ©:
- μ΅΄μ¬ν•λ” TODO μ‚­μ  (204)
- μ΅΄μ¬ν•μ§€ μ•λ” TODO μ‚­μ  (404)
- μλ»λ ID ν•μ‹μΌλ΅ μ‚­μ  (422)
- μμ/0 ID μ²λ¦¬
- μ‚­μ  ν›„ μ΅°ν λ¶κ°€ ν™•μΈ
- μ—¬λ¬ TODO μ‚­μ 
- μμ •λ TODO μ‚­μ 
- μ΄λ―Έ μ‚­μ λ TODO μ¬μ‚­μ 
- λ‹¤λ¥Έ TODO λ³΄μ΅΄ ν™•μΈ
- νΉμ λ¬Έμ ν¬ν•¨ TODO μ‚­μ 
- μ‘λ‹µ μΌκ΄€μ„± ν…μ¤νΈ
- μ™„μ „ν• μ›ν¬ν”λ΅μ° ν›„ μ‚­μ 

#### ν…μ¤νΈ κ²°κ³Ό:
```
13 passed, 6 warnings in 0.30s
```

#### μ£Όμ” ν•™μµ ν¬μΈνΈ:
- **λ¦¬μ†μ¤ μ‚­μ **: 204 No Content μ‘λ‹µ
- **μ‚­μ  κ²€μ¦**: μ‚­μ  ν›„ μ΅°ν μ‹ 404 μ‘λ‹µ
- **λ°μ΄ν„° λ¬΄κ²°μ„±**: μ‚­μ λ λ¦¬μ†μ¤μ μ™„μ „ν• μ κ±°
- **μ›ν¬ν”λ΅μ° ν…μ¤νΈ**: μƒμ„±-μμ •-ν† κΈ€-μ‚­μ  μ „μ²΄ κ³Όμ •

---

## π“ μ „μ²΄ ν…μ¤νΈ ν„ν™©

### ν…μ¤νΈ μ‹¤ν–‰ ν†µκ³„
```bash
# μ „μ²΄ ν…μ¤νΈ μ‹¤ν–‰
python -m pytest tests/ -v --tb=short

# μ»¤λ²„λ¦¬μ§€ ν¬ν•¨ ν…μ¤νΈ
python -m pytest tests/ --cov=app --cov-report=html
```

### ν…μ¤νΈ νμΌ κµ¬μ΅°
```
tests/
β”β”€β”€ conftest.py                    # κ³µν†µ ν”½μ¤μ²
β”β”€β”€ unit/                          # λ‹¨μ„ ν…μ¤νΈ
β”‚   β”β”€β”€ test_basic.py             # κΈ°λ³Έ ν…μ¤νΈ (7κ°)
β”‚   β”β”€β”€ test_mocking.py           # Mock ν…μ¤νΈ (11κ°)
β”‚   β””β”€β”€ test_fixtures.py          # Fixture ν…μ¤νΈ (31κ°)
β””β”€β”€ integration/                   # ν†µν•© ν…μ¤νΈ
    β”β”€β”€ test_get_todos.py         # GET μ „μ²΄ μ΅°ν API ν…μ¤νΈ (9κ°)
    β”β”€β”€ test_get_todo.py          # GET λ‹¨μΌ μ΅°ν API ν…μ¤νΈ (8κ°)
    β”β”€β”€ test_post_todo.py         # POST μƒμ„± API ν…μ¤νΈ (13κ°)
    β”β”€β”€ test_patch_todo.py        # PATCH ν† κΈ€ API ν…μ¤νΈ (11κ°)
    β””β”€β”€ test_delete_todo.py       # DELETE μ‚­μ  API ν…μ¤νΈ (13κ°)
```

### μ΄ ν…μ¤νΈ μ: **105κ°**
- β… **105κ° ν†µκ³Ό**
- β **0κ° μ‹¤ν¨**
- β… **κ²½κ³ **: 0κ° (λ¨λ“  κ²½κ³  ν•΄κ²° μ™„λ£!)

---

## π› οΈ μ„¤μ •λ λ„κµ¬λ“¤

### 1. pytest.ini
```ini
[tool:pytest]
testpaths = tests
pythonpath = .
python_files = test_*.py *_test.py
python_functions = test_*
python_classes = Test*

markers =
    unit: λ‹¨μ„ ν…μ¤νΈ
    integration: ν†µν•© ν…μ¤νΈ
    slow: λλ¦° ν…μ¤νΈ
    database: λ°μ΄ν„°λ² μ΄μ¤ ν…μ¤νΈ

minversion = 6.0
addopts =
    --strict-markers
    --strict-config
    --verbose
    --tb=short
```

### 2. conftest.py μ£Όμ” ν”½μ¤μ²
- `engine`: ν…μ¤νΈμ© λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„
- `session`: ν…μ¤νΈμ© λ°μ΄ν„°λ² μ΄μ¤ μ„Έμ…
- `client`: FastAPI ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈ
- `sample_todo_data`: μƒν” TODO λ°μ΄ν„°
- `sample_todo_list`: μƒν” TODO λ©λ΅

### 3. κ°€μƒν™κ²½ μ„¤μ •
- **Python**: 3.13.0
- **pytest**: 8.4.2
- **pytest-asyncio**: 1.2.0
- **pytest-cov**: 7.0.0
- **httpx**: 0.28.1

---

## π“ ν•™μµ μ„±κ³Ό

### β… λ‹¬μ„±ν• λ©ν‘
1. **PyTest ν™κ²½ κµ¬μ¶•**: μ™„μ „ν• ν…μ¤νΈ ν™κ²½ μ„¤μ •
2. **Mock ν™μ©**: μ™Έλ¶€ μμ΅΄μ„± κ²©λ¦¬ λ° ν…μ¤νΈ
3. **Fixture ν™μ©**: ν¨μ¨μ μΈ ν…μ¤νΈ λ°μ΄ν„° κ΄€λ¦¬
4. **API ν…μ¤νΈ**: FastAPI μ—”λ“ν¬μΈνΈ μΆ…ν•© ν…μ¤νΈ
5. **ν…μ¤νΈ μλ™ν™”**: CI/CD μ¤€λΉ„ μ™„λ£

### π“ ν•µμ‹¬ μ—­λ‰ ν–¥μƒ
- **ν…μ¤νΈ μ„¤κ³„**: μ²΄κ³„μ μΈ ν…μ¤νΈ μΌ€μ΄μ¤ μ‘μ„±
- **μμ΅΄μ„± κ΄€λ¦¬**: Mockκ³Ό Fixtureλ¥Ό ν†µν• κ²©λ¦¬
- **μ—λ¬ μ²λ¦¬**: λ‹¤μ–‘ν• μ—λ¬ μ‹λ‚λ¦¬μ¤ κ²€μ¦
- **μ½”λ“ ν’μ§**: μλ™ν™”λ ν…μ¤νΈλ¥Ό ν†µν• ν’μ§ λ³΄μ¥

---

## π”„ λ‹¤μ λ‹¨κ³„ (μ¶”κ°€ ν•™μµ μ μ•)

### β… **λ¨λ“  κΈ°λ³Έ μ‹¤μµ μ™„λ£!**

### μ¶”κ°€ ν•™μµ μ μ•:
- **ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€ λ¶„μ„**
- **μ„±λ¥ ν…μ¤νΈ**
- **E2E ν…μ¤νΈ**
- **CI/CD ν†µν•©**
- **ν…μ¤νΈ λ¦¬ν¬ν…**
- **νλΌλ―Έν„°ν™”λ ν…μ¤νΈ ν™•μ¥**

---

## π“ μ£Όμ” ν•™μµ ν¬μΈνΈ μ”μ•½

### 1. ν…μ¤νΈ κ²©λ¦¬
- κ° ν…μ¤νΈλ” λ…λ¦½μ μΌλ΅ μ‹¤ν–‰λμ–΄μ•Ό ν•¨
- λ°μ΄ν„°λ² μ΄μ¤ μƒνƒλ¥Ό μ΄κΈ°ν™”ν•μ—¬ μΌκ΄€μ„± λ³΄μ¥

### 2. Mock ν™μ©
- μ™Έλ¶€ μμ΅΄μ„±μ„ MockμΌλ΅ λ€μ²΄ν•μ—¬ λΉ λ¥Έ ν…μ¤νΈ
- μ‹¤μ  λ„¤νΈμ›ν¬λ‚ νμΌ μ‹μ¤ν…μ— μμ΅΄ν•μ§€ μ•μ

### 3. Fixture κ΄€λ¦¬
- Scopeλ¥Ό μ μ ν μ„¤μ •ν•μ—¬ λ¦¬μ†μ¤ ν¨μ¨μ„± ν™•λ³΄
- μμ΅΄μ„± μ²΄μΈμ„ ν†µν• λ³µμ΅ν• ν…μ¤νΈ λ°μ΄ν„° κµ¬μ„±

### 4. API ν…μ¤νΈ
- μ‹¤μ  HTTP μ”μ²­/μ‘λ‹µμ„ ν†µν• ν†µν•© ν…μ¤νΈ
- λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤μ™€ μ—λ¬ μΌ€μ΄μ¤ κ²€μ¦

---

## π‰ κ²°λ΅ 

PyTest μ‹¤μµμ„ ν†µν•΄ **μ²΄κ³„μ μΈ ν…μ¤νΈ ν™κ²½**μ„ κµ¬μ¶•ν•κ³ , **λ‹¤μ–‘ν• ν…μ¤νΈ κΈ°λ²•**μ„ ν•™μµν–μµλ‹λ‹¤.

**105κ°μ ν…μ¤νΈ**κ°€ λ¨λ‘ μ„±κ³µμ μΌλ΅ ν†µκ³Όν•μ—¬, ν„μ¬ κµ¬ν„λ TODO APIμ **λ¨λ“  κΈ°λ¥λ“¤μ΄ μ •μƒμ μΌλ΅ μ‘λ™**ν•¨μ„ ν™•μΈν–μµλ‹λ‹¤.

μ΄μ  **μ•μ •μ μ΄κ³  ν™•μ¥ κ°€λ¥ν• ν…μ¤νΈ κΈ°λ°**μ΄ λ§λ ¨λμ—μΌλ©°, ν–¥ν›„ κΈ°λ¥ μ¶”κ°€λ‚ λ¦¬ν©ν† λ§ μ‹μ—λ„ **μλ™ν™”λ ν…μ¤νΈ**λ¥Ό ν†µν•΄ ν’μ§μ„ λ³΄μ¥ν•  μ μμµλ‹λ‹¤.

---

*μ‘μ„±μΌ: 2025-10-05*
*μ‘μ„±μ: AI Assistant*
*ν”„λ΅μ νΈ: Todo FastAPI Backend*
