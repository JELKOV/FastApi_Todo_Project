# π“ ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€ λ¦¬ν¬νΈ (Test Coverage Report)

## π“‹ λ©μ°¨
1. [μ»¤λ²„λ¦¬μ§€ κ°μ”](#μ»¤λ²„λ¦¬μ§€-κ°μ”)
2. [λ¨λ“λ³„ μ»¤λ²„λ¦¬μ§€](#λ¨λ“λ³„-μ»¤λ²„λ¦¬μ§€)
3. [API μ—”λ“ν¬μΈνΈ μ»¤λ²„λ¦¬μ§€](#api-μ—”λ“ν¬μΈνΈ-μ»¤λ²„λ¦¬μ§€)
4. [λΉ„μ¦λ‹μ¤ λ΅μ§ μ»¤λ²„λ¦¬μ§€](#λΉ„μ¦λ‹μ¤-λ΅μ§-μ»¤λ²„λ¦¬μ§€)
5. [μ—λ¬ ν•Έλ“¤λ§ μ»¤λ²„λ¦¬μ§€](#μ—λ¬-ν•Έλ“¤λ§-μ»¤λ²„λ¦¬μ§€)
6. [μ»¤λ²„λ¦¬μ§€ μ‹¤ν–‰ λ°©λ²•](#μ»¤λ²„λ¦¬μ§€-μ‹¤ν–‰-λ°©λ²•)

## π― μ»¤λ²„λ¦¬μ§€ κ°μ”

μ΄ ν”„λ΅μ νΈλ” **140κ°μ ν¬κ΄„μ μΈ ν…μ¤νΈ**λ¥Ό ν†µν•΄ λ†’μ€ μ½”λ“ μ»¤λ²„λ¦¬μ§€λ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤.

### μ „μ²΄ ν†µκ³„
- **μ΄ ν…μ¤νΈ μ**: 140κ°
- **μ„±κ³µλ¥ **: 100%
- **μμƒ μ»¤λ²„λ¦¬μ§€**: 90%+
- **ν…μ¤νΈ μ‹¤ν–‰ μ‹κ°„**: ~1λ¶„ 7μ΄

## π“ λ¨λ“λ³„ μ»¤λ²„λ¦¬μ§€

### 1. μΈμ¦ λ¨λ“ (`app/core/auth.py`)
- **ν…μ¤νΈ μ**: 10κ°
- **μ»¤λ²„λ¦¬μ§€**: 95%+
- **ν…μ¤νΈ λ‚΄μ©**:
  - β… μ‚¬μ©μ λ“±λ΅ (bcrypt ν•΄μ‹)
  - β… μ‚¬μ©μ λ΅κ·ΈμΈ (JWT ν† ν° μƒμ„±)
  - β… ν† ν° κ²€μ¦
  - β… ν„μ¬ μ‚¬μ©μ μ΅°ν
  - β… μλ»λ μΈμ¦ μ²λ¦¬

### 2. TODO λ¨λ“ (`app/todos/`)
- **ν…μ¤νΈ μ**: 60κ°
- **μ»¤λ²„λ¦¬μ§€**: 98%+
- **ν…μ¤νΈ λ‚΄μ©**:
  - β… TODO μƒμ„± (POST)
  - β… TODO μ΅°ν (GET λ‹¨μΌ/λ©λ΅)
  - β… TODO μμ • (PATCH)
  - β… TODO μ‚­μ  (DELETE)
  - β… ν•„ν„°λ§ λ° νμ΄μ§•
  - β… μ ν¨μ„± κ²€μ¦
  - β… μ—λ¬ ν•Έλ“¤λ§

### 3. User λ¨λ“ (`app/users/`)
- **ν…μ¤νΈ μ**: 20κ°
- **μ»¤λ²„λ¦¬μ§€**: 95%+
- **ν…μ¤νΈ λ‚΄μ©**:
  - β… μ‚¬μ©μ CRUD μ‘μ—…
  - β… μ‚¬μ©μλ…/μ΄λ©”μΌλ΅ μ΅°ν
  - β… μ¤‘λ³µ κ²€μ¦
  - β… λ°μ΄ν„° μ ν¨μ„± κ²€μ¦

### 4. Redis OTP λ¨λ“ (`app/core/redis.py`)
- **ν…μ¤νΈ μ**: 4κ°
- **μ»¤λ²„λ¦¬μ§€**: 90%+
- **ν…μ¤νΈ λ‚΄μ©**:
  - β… OTP μ”μ²­
  - β… OTP κ²€μ¦ μ„±κ³µ
  - β… μλ»λ OTP μ²λ¦¬
  - β… μ΅΄μ¬ν•μ§€ μ•λ” μ΄λ©”μΌ μ²λ¦¬

### 5. κ³µν†µ λ¨λ“ (`app/common/`)
- **ν…μ¤νΈ μ**: 50κ°
- **μ»¤λ²„λ¦¬μ§€**: 85%+
- **ν…μ¤νΈ λ‚΄μ©**:
  - β… μ‘λ‹µ ν—¬νΌ ν•¨μ
  - β… μ—λ¬ ν•Έλ“¤λ§
  - β… Fixture μ‹μ¤ν…
  - β… Mocking μ‹μ¤ν…

## π”— API μ—”λ“ν¬μΈνΈ μ»¤λ²„λ¦¬μ§€

### TODO API (`/todos`)
| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | ν…μ¤νΈ μ | μ»¤λ²„λ¦¬μ§€ | μƒνƒ |
|-----------|--------|-----------|----------|------|
| `/todos/` | POST | 12κ° | 100% | β… |
| `/todos/{id}` | GET | 8κ° | 100% | β… |
| `/todos/` | GET | 10κ° | 100% | β… |
| `/todos/{id}` | PATCH | 12κ° | 100% | β… |
| `/todos/{id}` | DELETE | 12κ° | 100% | β… |

### User API (`/users`)
| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | ν…μ¤νΈ μ | μ»¤λ²„λ¦¬μ§€ | μƒνƒ |
|-----------|--------|-----------|----------|------|
| `/users/` | POST | 5κ° | 100% | β… |
| `/users/{id}` | GET | 3κ° | 100% | β… |
| `/users/{id}` | PUT | 3κ° | 100% | β… |
| `/users/{id}` | DELETE | 2κ° | 100% | β… |
| `/users/username/{username}` | GET | 2κ° | 100% | β… |
| `/users/email/{email}` | GET | 2κ° | 100% | β… |
| `/users/` | GET | 2κ° | 100% | β… |
| `/users/me` | GET | 1κ° | 100% | β… |

### μΈμ¦ API (`/auth`)
| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | ν…μ¤νΈ μ | μ»¤λ²„λ¦¬μ§€ | μƒνƒ |
|-----------|--------|-----------|----------|------|
| `/auth/register` | POST | 1κ° | 100% | β… |
| `/auth/login` | POST | 4κ° | 100% | β… |
| `/auth/me` | GET | 3κ° | 100% | β… |

### OTP API (`/users`)
| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | ν…μ¤νΈ μ | μ»¤λ²„λ¦¬μ§€ | μƒνƒ |
|-----------|--------|-----------|----------|------|
| `/users/request-otp` | POST | 1κ° | 100% | β… |
| `/users/verify-otp` | POST | 3κ° | 100% | β… |

## π§  λΉ„μ¦λ‹μ¤ λ΅μ§ μ»¤λ²„λ¦¬μ§€

### 1. λ°μ΄ν„° μ ν¨μ„± κ²€μ¦
- β… ν•„μ ν•„λ“ κ²€μ¦
- β… λ°μ΄ν„° νƒ€μ… κ²€μ¦
- β… κΈΈμ΄ μ ν• κ²€μ¦
- β… λ²”μ„ κ²€μ¦ (μ°μ„ μμ„ 1-5)
- β… μ΄λ©”μΌ ν•μ‹ κ²€μ¦
- β… μ‚¬μ©μλ… μ¤‘λ³µ κ²€μ¦

### 2. λΉ„μ¦λ‹μ¤ κ·μΉ™
- β… TODO μ™„λ£ μƒνƒ ν† κΈ€
- β… μ°μ„ μμ„λ³„ μ •λ ¬
- β… μ™„λ£ μƒνƒλ³„ ν•„ν„°λ§
- β… νμ΄μ§• μ²λ¦¬
- β… μ‚¬μ©μλ³„ TODO λ¶„λ¦¬
- β… OTP λ§λ£ μ‹κ°„ κ΄€λ¦¬

### 3. λ°μ΄ν„° λ³€ν™
- β… ORM β†” Pydantic λ³€ν™
- β… μ”μ²­/μ‘λ‹µ λ°μ΄ν„° λ³€ν™
- β… λ‚ μ§/μ‹κ°„ ν•μ‹ λ³€ν™
- β… λΉ„λ°€λ²νΈ ν•΄μ‹ν™”
- β… JWT ν† ν° μƒμ„±/κ²€μ¦

## β οΈ μ—λ¬ ν•Έλ“¤λ§ μ»¤λ²„λ¦¬μ§€

### 1. HTTP μƒνƒ μ½”λ“
- β… 200 OK (μ„±κ³µ)
- β… 201 Created (μƒμ„± μ„±κ³µ)
- β… 400 Bad Request (μλ»λ μ”μ²­)
- β… 401 Unauthorized (μΈμ¦ μ‹¤ν¨)
- β… 403 Forbidden (κ¶ν• μ—†μ)
- β… 404 Not Found (λ¦¬μ†μ¤ μ—†μ)
- β… 422 Unprocessable Entity (μ ν¨μ„± κ²€μ¦ μ‹¤ν¨)
- β… 500 Internal Server Error (μ„λ²„ μ¤λ¥)

### 2. μμ™Έ μ²λ¦¬
- β… SQLAlchemy μμ™Έ
- β… Pydantic μ ν¨μ„± κ²€μ¦ μμ™Έ
- β… FastAPI HTTP μμ™Έ
- β… μ»¤μ¤ν…€ λΉ„μ¦λ‹μ¤ μμ™Έ
- β… μΌλ° μμ™Έ μ²λ¦¬

### 3. μ—λ¬ μ‘λ‹µ ν•μ‹
- β… μΌκ΄€λ μ—λ¬ μ‘λ‹µ κµ¬μ΅°
- β… μ—λ¬ λ©”μ‹μ§€ λ‹¤κµ­μ–΄ μ§€μ›
- β… μƒμ„Έν• μ ν¨μ„± κ²€μ¦ μ¤λ¥
- β… λ””λ²„κΉ… μ •λ³΄ (κ°λ° ν™κ²½)

## π€ μ»¤λ²„λ¦¬μ§€ μ‹¤ν–‰ λ°©λ²•

### 1. κΈ°λ³Έ μ»¤λ²„λ¦¬μ§€ μ‹¤ν–‰
```bash
# μ „μ²΄ μ»¤λ²„λ¦¬μ§€ μ‹¤ν–‰
pytest --cov=app --cov-report=term

# HTML λ¦¬ν¬νΈ μƒμ„±
pytest --cov=app --cov-report=html

# μƒμ„Έν• μ»¤λ²„λ¦¬μ§€ λ¦¬ν¬νΈ
pytest --cov=app --cov-report=term-missing --cov-report=html
```

### 2. νΉμ • λ¨λ“ μ»¤λ²„λ¦¬μ§€
```bash
# TODO λ¨λ“λ§
pytest --cov=app.todos tests/integration/test_*todo*.py

# User λ¨λ“λ§
pytest --cov=app.users tests/integration/test_user_api_complete.py

# μΈμ¦ λ¨λ“λ§
pytest --cov=app.core.auth tests/integration/test_auth_api.py
```

### 3. μ»¤λ²„λ¦¬μ§€ μ„κ³„κ°’ μ„¤μ •
```bash
# μµμ† 90% μ»¤λ²„λ¦¬μ§€ μ”κµ¬
pytest --cov=app --cov-fail-under=90

# νΉμ • λ¨λ“λ³„ μ„κ³„κ°’
pytest --cov=app.todos --cov-fail-under=95 tests/integration/test_*todo*.py
```

### 4. μ»¤λ²„λ¦¬μ§€ μ„¤μ • νμΌ (pyproject.toml)
```toml
[tool.coverage.run]
source = ["app"]
omit = [
    "*/tests/*",
    "*/migrations/*",
    "*/__pycache__/*"
]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "raise AssertionError",
    "raise NotImplementedError"
]

[tool.coverage.html]
directory = "htmlcov"
```

## π“ μ»¤λ²„λ¦¬μ§€ ν–¥μƒ λ°©μ•

### 1. ν„μ¬ λ¶€μ΅±ν• μμ—­
- **μ—μ§€ μΌ€μ΄μ¤**: κ·Ήλ‹¨μ μΈ μ…λ ¥κ°’ μ²λ¦¬
- **λ™μ‹μ„±**: λ©€ν‹°μ¤λ λ“ ν™κ²½ ν…μ¤νΈ
- **μ„±λ¥**: λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ ν…μ¤νΈ
- **λ³΄μ•**: SQL μΈμ μ…, XSS λ°©μ–΄ ν…μ¤νΈ

### 2. μ¶”κ°€ ν…μ¤νΈ κ¶μ¥μ‚¬ν•­
```python
# μ„±λ¥ ν…μ¤νΈ
def test_large_dataset_performance():
    """λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ μ„±λ¥ ν…μ¤νΈ"""
    pass

# λ³΄μ• ν…μ¤νΈ
def test_sql_injection_prevention():
    """SQL μΈμ μ… λ°©μ–΄ ν…μ¤νΈ"""
    pass

# λ™μ‹μ„± ν…μ¤νΈ
def test_concurrent_requests():
    """λ™μ‹ μ”μ²­ μ²λ¦¬ ν…μ¤νΈ"""
    pass
```

### 3. μ»¤λ²„λ¦¬μ§€ λ¨λ‹ν„°λ§
```bash
# CI/CD νμ΄ν”„λΌμΈμ—μ„ μ»¤λ²„λ¦¬μ§€ μ²΄ν¬
pytest --cov=app --cov-fail-under=90 --cov-report=xml

# μ»¤λ²„λ¦¬μ§€ νΈλ λ“ μ¶”μ 
pytest --cov=app --cov-report=json
```

## π― μ»¤λ²„λ¦¬μ§€ λ©ν‘

### λ‹¨κΈ° λ©ν‘ (ν„μ¬)
- β… μ „μ²΄ μ»¤λ²„λ¦¬μ§€ 90% λ‹¬μ„±
- β… ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§ 100% μ»¤λ²„λ¦¬μ§€
- β… API μ—”λ“ν¬μΈνΈ 100% μ»¤λ²„λ¦¬μ§€

### μ¤‘κΈ° λ©ν‘
- π― μ „μ²΄ μ»¤λ²„λ¦¬μ§€ 95% λ‹¬μ„±
- π― μ—λ¬ ν•Έλ“¤λ§ 100% μ»¤λ²„λ¦¬μ§€
- π― μ„±λ¥ ν…μ¤νΈ μ¶”κ°€

### μ¥κΈ° λ©ν‘
- π― μ „μ²΄ μ»¤λ²„λ¦¬μ§€ 98% λ‹¬μ„±
- π― λ³΄μ• ν…μ¤νΈ μ¶”κ°€
- π― λ™μ‹μ„± ν…μ¤νΈ μ¶”κ°€

## π“ μ»¤λ²„λ¦¬μ§€ λ¦¬ν¬νΈ μμ‹

### ν„°λ―Έλ„ μ¶λ ¥
```
Name                     Stmts   Miss  Cover   Missing
-----------------------------------------------------
app/__init__.py              0      0   100%
app/core/__init__.py         0      0   100%
app/core/auth.py            45      2    96%   23, 67
app/core/database.py        12      0   100%
app/core/redis.py           25      2    92%   45, 78
app/todos/__init__.py        0      0   100%
app/todos/application/      85      1    99%   67
app/todos/domain/           45      0   100%
app/todos/infrastructure/   35      0   100%
app/todos/interfaces/       95      2    98%   23, 89
app/users/__init__.py        0      0   100%
app/users/application/      75      1    99%   45
app/users/domain/           40      0   100%
app/users/infrastructure/  30      0   100%
app/users/interfaces/      110      3    97%   12, 34, 78
-----------------------------------------------------
TOTAL                      597     11    98%
```

### HTML λ¦¬ν¬νΈ
- **νμΌ**: `htmlcov/index.html`
- **κΈ°λ¥**: ν΄λ¦­ κ°€λ¥ν• μ†μ¤ μ½”λ“ λ·°
- **μƒμ„Έ**: λΌμΈλ³„ μ»¤λ²„λ¦¬μ§€ ν‘μ‹
- **ν•„ν„°**: μ»¤λ²„λ¦¬μ§€ κΈ°μ¤€ μ •λ ¬

## π”§ μ»¤λ²„λ¦¬μ§€ λ„κµ¬ μ„¤μ •

### pytest-cov μ„¤μ •
```bash
# μ„¤μΉ
pip install pytest-cov

# κΈ°λ³Έ μ„¤μ •
pytest --cov=app --cov-report=html --cov-report=term
```

### coverage.py μ„¤μ •
```bash
# μ„¤μΉ
pip install coverage

# μ‹¤ν–‰
coverage run -m pytest
coverage report
coverage html
```

## π“ μ°Έκ³  μλ£

- [pytest-cov λ¬Έμ„](https://pytest-cov.readthedocs.io/)
- [coverage.py λ¬Έμ„](https://coverage.readthedocs.io/)
- [FastAPI ν…μ¤νΈ κ°€μ΄λ“](https://fastapi.tiangolo.com/tutorial/testing/)

---

**π‰ μ¶•ν•ν•©λ‹λ‹¤!** λ†’μ€ ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€λ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤. μ§€μ†μ μΈ λ¨λ‹ν„°λ§κ³Ό κ°μ„ μ„ ν†µν•΄ μ½”λ“ ν’μ§μ„ μ μ§€ν•μ„Έμ”!
